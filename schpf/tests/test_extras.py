#!/usr/bin/env python

import numpy as np
from numpy.testing import assert_equal

from schpf import max_pairwise


def test_overlap():
    X = np.array([
            [0.33973751, 0.72029002, 0.52763837, 0.94012605, 0.20375346],
            [0.32460224, 0.43595206, 0.8304655 , 0.31792094, 0.77330563],
            [0.00507031, 0.42707696, 0.26948512, 0.50554657, 0.31438824],
            [0.52583849, 0.54531833, 0.08530654, 0.35516516, 0.10617843],
            [0.78608326, 0.59571929, 0.09737211, 0.09474643, 0.55319175],
            [0.04245016, 0.43322226, 0.99748447, 0.45731582, 0.65861378],
            [0.04364505, 0.97239799, 0.68847276, 0.96692073, 0.60268244],
            [0.13364376, 0.40121588, 0.32770517, 0.02352124, 0.04974099],
            [0.92531954, 0.23635494, 0.29327799, 0.40788107, 0.95974159],
            [0.42295065, 0.5725946 , 0.59206089, 0.76534785, 0.77961214]])
    assert_equal(max_pairwise(X, ntop=3)[0], 2)

